<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title><i class="fas fa-balance-scale"></i>Recrutement Marin – ICS-benin Recrutement</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    /* ---------- RESET & BASE ---------- */
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height:1.6;
      color:#333;
      background:#f8fbff;
    }
    h1, h2, h3 { margin-bottom:0.5em; font-weight:700; }
    .section {
      padding:3rem 1rem;
      text-align:center;
    }
    .btn {
      display:inline-block;
      background:#0056b3;
      color:#fff;
      padding:0.8rem 1.5rem;
      border-radius:30px;
      text-decoration:none;
      font-weight:600;
      transition: all 0.3s ease;
      font-size: 0.95rem;
    }
    .btn:hover {
      background:#003d82;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .btn-whatsapp {
      position:fixed;
      bottom:20px;
      right:20px;
      background:#25D366;
      color:#fff;
      width:55px;
      height:55px;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:1.8rem;
      box-shadow: 0 4px 12px rgba(37,211,102,0.4);
      z-index:1000;
      text-decoration:none;
      transition: all 0.3s ease;
    }
    .btn-whatsapp:hover {
      transform: scale(1.1);
      background:#128C7E;
    }

    /* ---------- HEADER ---------- */
    .site-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:#002147;
      color:#fff;
      padding:0.8rem 1rem;
      position:relative;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 10;
    }
    .logo {
      font-weight:bold;
      font-size:1.3rem;
      display:flex;
      align-items:center;
      gap:0.5rem;
    }
    .nav a {
      color:#fff;
      text-decoration:none;
      margin-left:1rem;
      font-weight:500;
      font-size: 0.95rem;
      transition: color 0.3s;
    }
    .nav a:hover {
      color:#a0d8ef;
    }
    .nav-toggle {
      display:none;
      background:none;
      border:none;
      color:#fff;
      font-size:1.6rem;
      cursor:pointer;
    }

    /* ---------- HERO SLIDER ---------- */
    .hero-slider {
      position: relative;
      width: 100%;
      height: 60vh;
      max-height: 600px;
      overflow: hidden;
    }
    .slides {
      display: flex;
      width: 500%; /* 5 images */
      height: 100%;
      transition: transform 0.8s ease-in-out;
    }
    .slide {
      width: 20%;
      height: 100%;
      flex-shrink: 0;
      background-size: cover;
      background-position: center;
      position: relative;
    }
    .slide::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      /*background: linear-gradient(rgba(0,33,71,0.85), rgba(0,33,71,0.95));*/
    }
    .hero-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #fff;
      z-index: 5;
      width: 90%;
      max-width: 800px;
    }
    .hero-content h1 {
      font-size:2.2rem;
      margin-bottom:1rem;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      line-height: 1.2;
    }
    .hero-content p {
      font-size:1.1rem;
      margin:0 auto 1.5rem;
    }

    /* Indicateurs */
    .slider-indicators {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      z-index: 6;
    }
    .indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: rgba(255,255,255,0.5);
      cursor: pointer;
      transition: background 0.3s;
    }
    .indicator.active {
      background: #fff;
    }

    /* ---------- OFFRES ---------- */
    .cards {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
      gap:1.5rem;
      margin-top:2rem;
      padding:0 0.5rem;
    }
    .card {
      background:#fff;
      padding:1.5rem;
      border-radius:12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      transition: transform 0.3s ease;
      text-align:left;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.1);
    }
    .card i {
      font-size:2rem;
      color:#0056b3;
      margin-bottom:0.8rem;
    }
    .card h3 { font-size: 1.2rem; }
    .card p { font-size: 0.95rem; }

    /* ---------- FORMULAIRE PERSONNALISÉ ---------- */
    .form-container {
      max-width:900px;
      margin:2rem auto;
      background:#fff;
      padding:1.8rem;
      border-radius:12px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.08);
      text-align:left;
    }
    .form-section {
      margin-bottom:1.8rem;
    }
    .section-title {
      text-align: left;
      font-size:1.3rem;
      color:#002147;
      margin-bottom:1rem;
      display:flex;
      align-items:center;
      gap:0.5rem;
    }
    .form-row {
      display:grid;
      grid-template-columns:1fr;
      gap:1rem;
      margin-bottom:1rem;
    }
    @media (min-width: 768px) {
      .form-row {
        grid-template-columns: 1fr 1fr;
      }
    }
    .form-group {
      margin-bottom:1rem;
    }
    .form-group label {
      display:block;
      margin-bottom:0.5rem;
      font-weight:600;
      color:#002147;
      font-size: 0.95rem;
    }
    .required:after {
      content: " *";
      color: #e74c3c;
    }
    .input-with-icon {
      position: relative;
      display: flex;
      align-items: center;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 0.7rem;
      background: #fff;
    }
    .input-with-icon i {
      color: #0056b3;
      margin-right: 0.7rem;
      width: 20px;
      text-align: center;
      font-size: 0.9rem;
    }
    .input-with-icon input,
    .input-with-icon select {
      flex: 1;
      border: none;
      outline: none;
      font-size: 0.95rem;
      padding: 0;
    }
    .photo-upload,
    .pdf-upload {
      border: 2px dashed #0056b3;
      border-radius: 8px;
      padding: 1.2rem 1rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: #f8fbff;
      font-size: 0.9rem;
    }
    .photo-upload:hover,
    .pdf-upload:hover {
      background: #e3f2fd;
    }
    .photo-upload .photo-icon,
    .pdf-upload .pdf-icon {
      font-size: 2rem;
      color: #0056b3;
      margin-bottom: 0.5rem;
    }
    .photo-preview {
      margin-top: 0.8rem;
      max-width: 120px;
      margin: 0.8rem auto 0;
    }
    .photo-preview img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      border: 1px solid #ddd;
      display: block;
    }
    .pdf-list {
      margin-top: 0.8rem;
      text-align: left;
      font-size: 0.9rem;
    }
    .pdf-list .file-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.4rem 0.6rem;
      background: #e3f2fd;
      border-radius: 4px;
      margin-bottom: 0.4rem;
      font-size: 0.85rem;
    }
    .btn-submit {
      background: #27ae60;
      color: white;
      padding: 0.9rem 2rem;
      font-size: 1rem;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      display: block;
      margin: 1.5rem auto 0;
      transition: all 0.3s;
      font-weight: 600;
    }
    .btn-submit:hover {
      background: #219653;
      transform: translateY(-2px);
    }

    /* ---------- TABLEAU DES DONNÉES ---------- */
    .data-table-container {
      margin-top: 2rem;
      background: #fff;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.05);
    }
    .empty-table-message {
      color: #777;
      font-style: italic;
      margin: 1.5rem 0;
      font-size: 0.95rem;
    }
    .marins-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.2rem;
    }
    .marin-card {
      background: #f8fbff;
      border: 1px solid #e0e0e0;
      border-radius: 12px;
      padding: 1rem;
      text-align: left;
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
      font-size: 0.9rem;
      width: 100%;
      max-width: 100%;
      overflow: hidden;
      word-break: break-word;
      box-sizing: border-box;
    }
    .marin-photo {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 8px;
      border: 1px solid #ddd;
      background: #f0f0f0;
    }
    .marin-info h4 {
      color: #002147;
      margin: 0;
      font-size: 1.1rem;
      font-weight: 700;
      word-break: break-word;
    }
    .marin-info p {
      margin: 0.2rem 0;
      font-size: 0.88rem;
      color: #555;
      line-height: 1.4;
      word-break: break-word;
    }
    .marin-files {
      background: #f0f7ff;
      padding: 0.7rem;
      border-radius: 6px;
      font-size: 0.85rem;
      max-height: 100px;
      overflow-y: auto;
      word-break: break-word;
    }
    .marin-actions {
      margin-top: auto;
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    .btn-small {
      padding: 0.35rem 0.7rem;
      font-size: 0.8rem;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      white-space: nowrap;
    }
    .btn-edit {
      background: #f39c12;
      color: white;
    }
    .btn-delete {
      background: #e74c3c;
      color: white;
    }

    /* ---------- FOOTER ---------- */
    .site-footer {
      background:#002147;
      color:#fff;
      text-align:center;
      padding:1.5rem 1rem;
      margin-top:2rem;
      font-size: 0.9rem;
    }
    .footer-links {
      margin-top:0.8rem;
    }
    .footer-links a {
      color:#a0d8ef;
      margin:0 0.6rem;
      text-decoration:none;
      font-size: 0.88rem;
    }
    .footer-links a:hover {
      text-decoration:underline;
    }

    /* ---------- RESPONSIVE MENU ---------- */
    @media (max-width:768px) {
      .nav {
        display:none;
        flex-direction:column;
        background:#002147;
        position:absolute;
        top:65px;
        right:0;
        width:200px;
        padding:1rem;
        box-shadow: -5px 5px 10px rgba(0,0,0,0.1);
      }
      .nav a {
        margin:0.6rem 0;
        display:block;
        font-size: 1rem;
      }
      .nav-toggle {
        display:block;
      }
      .nav.open {
        display:flex;
      }
      .hero-slider {
        height: 50vh;
      }
      .hero-content h1 {
        font-size:1.8rem;
      }
      .hero-content p {
        font-size: 1rem;
      }
      .section {
        padding: 2rem 1rem;
      }
      .form-container {
        padding: 1.5rem;
        margin: 1.5rem auto;
      }
      .marin-card {
        padding: 0.9rem;
      }
      .marin-photo {
        height: 140px;
      }
      .marin-info h4 {
        font-size: 1rem;
      }
      .marin-info p {
        font-size: 0.85rem;
      }
      .marin-actions {
        flex-direction: column;
        gap: 0.4rem;
      }
      .btn-small {
        width: 100%;
      }
    }

    @media (max-width: 480px) {
      .hero-content h1 {
        font-size: 1.5rem;
      }
      .hero-content p {
        font-size: 0.95rem;
      }
      .marins-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      .marin-card {
        padding: 0.7rem;
        font-size: 0.87rem;
      }
      .marin-photo {
        height: 130px;
      }
      .marin-info h4 {
        font-size: 0.95rem;
      }
      .marin-info p {
        font-size: 0.82rem;
      }
      .marin-files {
        font-size: 0.8rem;
        padding: 0.6rem;
      }
      .btn-submit {
        padding: 0.8rem 1.5rem;
        font-size: 0.95rem;
      }
    }
    
    /* Loading & Status Styles */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      display: none;
    }
    
    .loading-content {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      max-width: 400px;
    }
    
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #0056b3;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .status-message {
      font-size: 1.1rem;
      margin: 1rem 0;
      color: #333;
    }
    
    .success-icon {
      color: #27ae60;
      font-size: 2.5rem;
      margin: 0.5rem 0;
    }
    
    .error-icon {
      color: #e74c3c;
      font-size: 2.5rem;
      margin: 0.5rem 0;
    }
  </style>
</head>
<body>

<!-- ===== HEADER ===== -->
<header class="site-header">
  <div class="logo">
    <i class="fas fa-ship"></i> ICS-benin
  </div> 
  <nav class="nav" id="navMenu">
    <a href="#accueil">Accueil</a>
    <a href="#offres">Offres</a>
    <a href="#recrutement">Recrutement</a>
    <a href="#contact">Contact</a>
  </nav>
  <button class="nav-toggle" id="navToggle">☰</button>
</header>

<!-- ===== HERO SLIDER ===== -->
<section id="accueil" class="hero-slider">
  <div class="slides">
    <div class="slide" style="background-image: url('https://picsum.photos/1200/600?navy1');"></div>
    <div class="slide" style="background-image: url('https://picsum.photos/1200/600?navy2');"></div>
    <div class="slide" style="background-image: url('https://picsum.photos/1200/600?navy3');"></div>
    <div class="slide" style="background-image: url('https://picsum.photos/1200/600?navy4');"></div>
    <div class="slide" style="background-image: url('https://picsum.photos/1200/600?navy5');"></div>
  </div>
  <div class="hero-content">
    <h1>Rejoignez les Équipages d'Excellence 🌊</h1>
    <p>ICS-benin recrute des marins expérimentés pour les plus beaux navires du monde.</p>
    <a href="#recrutement" class="btn">Postuler Maintenant</a>
  </div>
  <div class="slider-indicators">
    <span class="indicator active" data-slide="0"></span>
    <span class="indicator" data-slide="1"></span>
    <span class="indicator" data-slide="2"></span>
    <span class="indicator" data-slide="3"></span>
    <span class="indicator" data-slide="4"></span>
  </div>
</section>

<!-- ===== OFFRES ===== -->
<section id="offres" class="services section">
  <h2>Postes Disponibles</h2>
  <div class="cards">
    <div class="card">
      <i class="fas fa-ship"></i>
      <h3>Capitaine de Pont</h3>
      <p>Expérience requise : 5 ans min. Contrat CDI.</p>
    </div>
    <div class="card">
      <i class="fas fa-anchor"></i>
      <h3>Matelot Polyvalent</h3>
      <p>Débutants acceptés. Formation offerte.</p>
    </div>
    <div class="card">
      <i class="fas fa-wrench"></i>
      <h3>Mécanicien Marin</h3>
      <p>Certification STCW obligatoire.</p>
    </div>
  </div>
</section>

<!-- ===== FORMULAIRE DE RECRUTEMENT ===== -->
<section id="recrutement" class="section">
  <h2>Inscription des Marins</h2>
  <div class="form-container">
    <form id="registrationForm">
      <input type="hidden" id="marinId" value="">
      <div class="form-section">
        <h2 class="section-title"><i class="fas fa-id-card"></i> Informations personnelles</h2>
        <div class="form-row">
          <div class="form-group">
            <label for="photo" class="required">Photo</label>
            <div class="photo-upload" id="photoUpload">
              <div class="photo-icon">
                <i class="fas fa-camera"></i>
              </div>
              <p>Cliquez pour télécharger</p>
              <div class="photo-preview" id="photoPreview"></div>
            </div>
            <input type="file" id="photo" accept="image/*" style="display: none;">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="nom" class="required">Nom</label>
            <div class="input-with-icon">
              <i class="fas fa-user"></i>
              <input type="text" id="nom" placeholder="Votre nom" required>
            </div>
          </div>
          <div class="form-group">
            <label for="prenom" class="required">Prénoms</label>
            <div class="input-with-icon">
              <i class="fas fa-user"></i>
              <input type="text" id="prenom" placeholder="Vos prénoms" required>
            </div>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="nationalite" class="required">Nationalité</label>
            <div class="input-with-icon">
              <i class="fas fa-flag"></i>
              <input type="text" id="nationalite" placeholder="Votre nationalité" required>
            </div>
          </div>
          <div class="form-group">
            <label for="situation_matrimoniale" class="required">Situation</label>
            <div class="input-with-icon">
              <i class="fas fa-heart"></i>
              <select id="situation_matrimoniale" required>
                <option value="">-- Sélectionnez --</option>
                <option value="celibataire">Célibataire</option>
                <option value="marie">Marié(e)</option>
                <option value="divorce">Divorcé(e)</option>
                <option value="veuf">Veuf(ve)</option>
              </select>
            </div>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="age" class="required">Âge</label>
            <div class="input-with-icon">
              <i class="fas fa-birthday-cake"></i>
              <input type="number" id="age" min="18" max="65" placeholder="Votre âge" required>
            </div>
          </div>
          <div class="form-group">
            <label for="telephone" class="required">Téléphone</label>
            <div class="input-with-icon">
              <i class="fas fa-phone"></i>
              <input type="tel" id="telephone" placeholder="Votre numéro" required>
            </div>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="metier" class="required">Poste choisi</label>
            <div class="input-with-icon">
              <i class="fas fa-tools"></i>
              <select id="metier" required>
                <option value="">-- Choisissez un poste --</option>
                <optgroup label="Navire - Pont">
                  <option value="capitaine">Capitaine</option>
                  <option value="premier_officier">Premier Officier</option>
                  <option value="second_officier">Second Officier</option>
                  <option value="third_officier">Third Officier</option>
                  <option value="maitre_equipage">Maître d'équipage</option>
                  <option value="matelot_qualifie">Matelot Qualifié</option>
                  <option value="matelot">Matelot</option>
                </optgroup>
                <optgroup label="Navire - Machine">
                  <option value="chef_mecanicien">Chef Mécanicien</option>
                  <option value="second_mecanicien">Second Mécanicien</option>
                  <option value="third_mecanicien">Third Mécanicien</option>
                  <option value="fourth_mecanicien">Fourth Mécanicien</option>
                  <option value="mecanicien">Mécanicien</option>
                  <option value="wiper">Wiper</option>
                  <option value="electrotechnicien">Électrotechnicien</option>
                </optgroup>
                <optgroup label="Navire - Services">
                  <option value="chef_steward">Chef Steward</option>
                  <option value="cuisinier">Cuisinier</option>
                  <option value="steward">Steward</option>
                </optgroup>
                <optgroup label="Forage - Management">
                  <option value="chef_plateforme">Chef de Plateforme</option>
                  <option value="chef_forage">Chef de Forage</option>
                  <option value="ingenieur_forage">Ingénieur de Forage</option>
                  <option value="geologue">Géologue</option>
                </optgroup>
                <optgroup label="Forage - Opérations">
                  <option value="maitre_sondeur">Maître-Sondeur</option>
                  <option value="aide_sondeur">Aide-Sondeur</option>
                  <option value="roughneck">Ouvrier de Plancher</option>
                </optgroup>
                <optgroup label="Forage - Support">
                  <option value="ingenieur_boue">Ingénieur de Boue</option>
                  <option value="technicien_maintenance">Technicien en Maintenance</option>
                  <option value="electricien">Électricien</option>
                  <option value="soudeur">Soudeur</option>
                  <option value="securite">Préposé à la Sécurité</option>
                </optgroup>
              </select>
            </div>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="cv_pdf" class="required">CV (PDF)</label>
            <div class="pdf-upload" id="cvUpload">
              <div class="pdf-icon">
                <i class="fas fa-file-pdf"></i>
              </div>
              <p>Téléchargez votre CV</p>
              <div class="pdf-list" id="cvList"></div>
            </div>
            <input type="file" id="cv_pdf" accept=".pdf" style="display: none;">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="certificats_pdf" class="required">Certificats</label>
            <div class="pdf-upload" id="certificatsUpload">
              <div class="pdf-icon">
                <i class="fas fa-graduation-cap"></i>
              </div>
              <p>Certificats (PDF, multiples)</p>
              <div class="pdf-list" id="certificatsList"></div>
            </div>
            <input type="file" id="certificats_pdf" accept=".pdf" multiple style="display: none;">
          </div>
        </div>
      </div>
      <button type="submit" class="btn-submit" id="submitButton">
        <i class="fas fa-paper-plane"></i> Envoyer ma candidature
      </button>
    </form>

    <div class="data-table-container">
      <h2 class="section-title"><i class="fas fa-database"></i> Marins enregistrés</h2>
      <div id="emptyMessage" class="empty-table-message">
        Aucun marin enregistré.
      </div>
      <div class="marins-grid" id="marinsGrid"></div>
    </div>
  </div>
</section>

<!-- ===== CONTACT / FOOTER ===== -->
<section id="contact" class="section" style="background:#003a70; color:#fff; padding: 2rem 1rem;">
  <h2>Questions ?</h2>
  <p><strong>+229 0196107163</strong> — ics-benin@gmail.com</p>
</section>

<footer class="site-footer">
  <p>© 2025 OceanPro Recrutement</p>
  <div class="footer-links">
    <a href="#">Mentions Légales</a>
    <a href="#">Confidentialité</a>
    <a href="#">FAQ</a>
  </div>
</footer>

<!-- ===== WHATSAPP BUTTON ===== -->
<a href="https://wa.me/2290196107163" class="btn-whatsapp" target="_blank" title="WhatsApp">
  <i class="fab fa-whatsapp"></i>
</a>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-content">
    <div class="loading-spinner"></div>
    <div class="status-message" id="statusMessage">Envoi de votre candidature en cours...<br>Veuillez patienter.</div>
  </div>
</div>

<script>
  // ========== SLIDER HERO ==========
  const slides = document.querySelector('.slides');
  const indicators = document.querySelectorAll('.indicator');
  let currentIndex = 0;
  const totalSlides = 5;

  function goToSlide(index) {
    slides.style.transform = `translateX(-${index * 20}%)`;
    indicators.forEach((ind, i) => {
      ind.classList.toggle('active', i === index);
    });
    currentIndex = index;
  }

  function nextSlide() {
    currentIndex = (currentIndex + 1) % totalSlides;
    goToSlide(currentIndex);
  }

  indicators.forEach(indicator => {
    indicator.addEventListener('click', () => {
      const slideIndex = parseInt(indicator.getAttribute('data-slide'));
      goToSlide(slideIndex);
    });
  });

  setInterval(nextSlide, 5000);

  // ========== MENU HAMBURGER ==========
  const navToggle = document.getElementById('navToggle');
  const navMenu = document.getElementById('navMenu');
  navToggle.addEventListener('click', () => {
    navMenu.classList.toggle('open');
  });

  // ========== FORM & SERVER COMMUNICATION ==========
  let marins = JSON.parse(localStorage.getItem('marins')) || [];
  const photoInput = document.getElementById('photo');
  const photoPreview = document.getElementById('photoPreview');
  const cvInput = document.getElementById('cv_pdf');
  const cvList = document.getElementById('cvList');
  const certificatsInput = document.getElementById('certificats_pdf');
  const certificatsList = document.getElementById('certificatsList');
  const marinsGrid = document.getElementById('marinsGrid');
  const emptyMessage = document.getElementById('emptyMessage');
  const registrationForm = document.getElementById('registrationForm');
  const loadingOverlay = document.getElementById('loadingOverlay');
  const statusMessage = document.getElementById('statusMessage');

  // Show loading overlay
  function showLoading(message) {
    statusMessage.innerHTML = message;
    loadingOverlay.style.display = 'flex';
  }

  // Hide loading overlay
  function hideLoading() {
    loadingOverlay.style.display = 'none';
  }

  // Show result message
  function showResult(isSuccess, message) {
    const icon = isSuccess ? '<i class="fas fa-check-circle success-icon"></i>' : '<i class="fas fa-times-circle error-icon"></i>';
    statusMessage.innerHTML = icon + '<div>' + message + '</div>';
    
    setTimeout(() => {
      hideLoading();
      if (isSuccess) {
        // Reset form and update UI
        registrationForm.reset();
        photoPreview.innerHTML = '';
        cvList.innerHTML = '';
        certificatsList.innerHTML = '';
        renderMarins();
      }
    }, 3000);
  }

  // Gestion Upload Photo
  document.getElementById('photoUpload').addEventListener('click', () => photoInput.click());
  photoInput.addEventListener('change', function() {
    if (this.files && this.files[0]) {
      const reader = new FileReader();
      reader.onload = function(e) {
        photoPreview.innerHTML = `<img src="${e.target.result}" alt="Photo du marin">`;
      };
      reader.readAsDataURL(this.files[0]);
    }
  });

  // Gestion Upload CV
  document.getElementById('cvUpload').addEventListener('click', () => cvInput.click());
  cvInput.addEventListener('change', function() {
    cvList.innerHTML = '';
    if (this.files && this.files[0]) {
      const file = this.files[0];
      cvList.innerHTML = `
        <div class="file-item">
          <i class="fas fa-file-pdf"></i>
          <span>${file.name}</span>
        </div>
      `;
    }
  });

  // Gestion Upload Certificats
  document.getElementById('certificatsUpload').addEventListener('click', () => certificatsInput.click());
  certificatsInput.addEventListener('change', function() {
    certificatsList.innerHTML = '';
    if (this.files) {
      Array.from(this.files).forEach(file => {
        const div = document.createElement('div');
        div.className = 'file-item';
        div.innerHTML = `
          <i class="fas fa-file-pdf"></i>
          <span>${file.name}</span>
        `;
        certificatsList.appendChild(div);
      });
    }
  });

  // Afficher les marins existants
  function renderMarins() {
    if (marins.length === 0) {
      emptyMessage.style.display = 'block';
      marinsGrid.innerHTML = '';
      return;
    }
    emptyMessage.style.display = 'none';
    marinsGrid.innerHTML = marins.map((marin, index) => `
      <div class="marin-card">
        ${marin.photo ? `<img src="${marin.photo}" alt="Photo de ${marin.prenom}" class="marin-photo">` : '<div class="marin-photo" style="display: flex; align-items: center; justify-content: center; color: #888; font-size: 2rem;"><i class="fas fa-user"></i></div>'}
        <div class="marin-info">
          <h4>${marin.prenom} ${marin.nom}</h4>
          <p><strong>Nationalité :</strong> ${marin.nationalite}</p>
          <p><strong>Situation :</strong> ${getSituationLabel(marin.situation_matrimoniale)}</p>
          <p><strong>Âge :</strong> ${marin.age} ans</p>
          <p><strong>Tél :</strong> ${marin.telephone}</p>
          <p><strong>Poste :</strong> ${getMetierLabel(marin.metier)}</p>
        </div>
        <div class="marin-files">
          ${marin.cvName ? `<p><i class="fas fa-file-pdf"></i> CV: ${marin.cvName}</p>` : ''}
          ${marin.certificatsNames && marin.certificatsNames.length > 0 ? 
            `<p><i class="fas fa-graduation-cap"></i> Certificats: ${marin.certificatsNames.slice(0,2).join(', ')}${marin.certificatsNames.length > 2 ? ' + ' + (marin.certificatsNames.length - 2) + ' autres' : ''}</p>` : ''}
        </div>
        <div class="marin-actions">
          <button class="btn-small btn-edit" onclick="editMarin(${index})">✏️ Modifier</button>
          <button class="btn-small btn-delete" onclick="deleteMarin(${index})">🗑️ Supprimer</button>
        </div>
      </div>
    `).join('');
  }

  // Helper pour les métiers
  function getMetierLabel(value) {
    const labels = {
      'capitaine': 'Capitaine',
      'premier_officier': '1er Officier',
      'second_officier': '2e Officier',
      'third_officier': '3e Officier',
      'maitre_equipage': 'Maître équipage',
      'matelot_qualifie': 'Matelot Qualifié',
      'matelot': 'Matelot',
      'chef_mecanicien': 'Chef Mécanicien',
      'second_mecanicien': '2e Mécanicien',
      'third_mecanicien': '3e Mécanicien',
      'fourth_mecanicien': '4e Mécanicien',
      'mecanicien': 'Mécanicien',
      'wiper': 'Wiper',
      'electrotechnicien': 'Électrotechnicien',
      'chef_steward': 'Chef Steward',
      'cuisinier': 'Cuisinier',
      'steward': 'Steward',
      'chef_plateforme': 'Chef Plateforme',
      'chef_forage': 'Chef Forage',
      'ingenieur_forage': 'Ing. Forage',
      'geologue': 'Géologue',
      'maitre_sondeur': 'Maître-Sondeur',
      'aide_sondeur': 'Aide-Sondeur',
      'roughneck': 'Roughneck',
      'ingenieur_boue': 'Ing. Boue',
      'technicien_maintenance': 'Tech. Maintenance',
      'electricien': 'Électricien',
      'soudeur': 'Soudeur',
      'securite': 'Sécurité'
    };
    return labels[value] || value;
  }

  // Helper pour la situation matrimoniale
  function getSituationLabel(value) {
    const options = {
      'celibataire': 'Célibataire',
      'marie': 'Marié(e)',
      'divorce': 'Divorcé(e)',
      'veuf': 'Veuf(ve)'
    };
    return options[value] || 'Non spécifié';
  }

  // Modifier un marin
  window.editMarin = function(index) {
    const marin = marins[index];
    document.getElementById('marinId').value = index;
    document.getElementById('nom').value = marin.nom;
    document.getElementById('prenom').value = marin.prenom;
    document.getElementById('nationalite').value = marin.nationalite;
    document.getElementById('situation_matrimoniale').value = marin.situation_matrimoniale;
    document.getElementById('age').value = marin.age;
    document.getElementById('telephone').value = marin.telephone;
    document.getElementById('metier').value = marin.metier;

    if (marin.photo) {
      photoPreview.innerHTML = `<img src="${marin.photo}" alt="Photo du marin">`;
    } else {
      photoPreview.innerHTML = '';
    }

    cvList.innerHTML = marin.cvName ? `
      <div class="file-item">
        <i class="fas fa-file-pdf"></i>
        <span>${marin.cvName}</span>
      </div>
    ` : '';

    certificatsList.innerHTML = '';
    if (marin.certificatsNames) {
      marin.certificatsNames.forEach(name => {
        const div = document.createElement('div');
        div.className = 'file-item';
        div.innerHTML = `
          <i class="fas fa-file-pdf"></i>
          <span>${name}</span>
        `;
        certificatsList.appendChild(div);
      });
    }

    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  // Supprimer un marin
  window.deleteMarin = function(index) {
    if (confirm("Supprimer ce marin ?")) {
      marins.splice(index, 1);
      localStorage.setItem('marins', JSON.stringify(marins));
      renderMarins();
      showToast("🗑️ Supprimé !");
    }
  };

  // Notification toast (pour les suppressions/modifs locales)
  function showToast(message) {
    const toast = document.createElement('div');
    toast.style.cssText = `
      position: fixed; top: 20px; right: 20px; background: #27ae60; color: white;
      padding: 0.8rem 1.2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 9999; font-weight: 600; font-size: 0.9rem;
    `;
    toast.innerHTML = message;
    document.body.appendChild(toast);
    setTimeout(() => {
      toast.style.opacity = '0';
      toast.style.transition = 'opacity 0.3s';
      setTimeout(() => {
        if (toast.parentNode) document.body.removeChild(toast);
      }, 300);
    }, 2500);
  }

  // Scroll doux
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        window.scrollTo({
          top: target.offsetTop - 70,
          behavior: 'smooth'
        });
        navMenu.classList.remove('open');
      }
    });
  });

  // ✅ SOUMISSION AU SERVEUR NODE.JS — URL MODIFIÉE POUR RENDER
  registrationForm.addEventListener('submit', async function(e) {
    e.preventDefault();

    const marinId = document.getElementById('marinId').value;
    const photoFile = photoInput.files[0];
    const cvFile = cvInput.files[0];
    const certificatsFiles = certificatsInput.files;

    const marin = {
      nom: document.getElementById('nom').value.trim(),
      prenom: document.getElementById('prenom').value.trim(),
      nationalite: document.getElementById('nationalite').value.trim(),
      situation_matrimoniale: document.getElementById('situation_matrimoniale').value,
      age: document.getElementById('age').value,
      telephone: document.getElementById('telephone').value.trim(),
      metier: document.getElementById('metier').value
    };

    // Validation
    if (!marin.nom || !marin.prenom || !marin.metier) {
      alert("Veuillez remplir les champs obligatoires.");
      return;
    }

    showLoading("Envoi de votre candidature en cours...<br>Veuillez patienter.");

    try {
      // Créer FormData pour envoyer fichiers + données
      const formData = new FormData();
      formData.append('nom', marin.nom);
      formData.append('prenom', marin.prenom);
      formData.append('nationalite', marin.nationalite);
      formData.append('situation_matrimoniale', marin.situation_matrimoniale);
      formData.append('age', marin.age);
      formData.append('telephone', marin.telephone);
      formData.append('metier', marin.metier);

      if (photoFile) formData.append('photo', photoFile);
      if (cvFile) formData.append('cv', cvFile);
      if (certificatsFiles && certificatsFiles.length > 0) {
        for (let file of certificatsFiles) {
          formData.append('certificats', file);
        }
      }

      // ✅ URL MODIFIÉE : utilise ton URL Render
      const response = await fetch('https://ICS-benin.onrender.com/api/send-application', {
        method: 'POST',
        body: formData
      });

      const result = await response.json();

      if (result.success) {
        // Sauvegarder en localStorage pour l'UI
        if (marinId === "") {
          // Ajouter photo et noms de fichiers pour l'affichage
          marin.photo = photoPreview.querySelector('img')?.src || '';
          marin.cvName = cvFile?.name || '';
          marin.certificatsNames = certificatsFiles ? Array.from(certificatsFiles).map(f => f.name) : [];
          marins.push(marin);
        } else {
          const existingMarin = marins[marinId];
          existingMarin.nom = marin.nom;
          existingMarin.prenom = marin.prenom;
          existingMarin.nationalite = marin.nationalite;
          existingMarin.situation_matrimoniale = marin.situation_matrimoniale;
          existingMarin.age = marin.age;
          existingMarin.telephone = marin.telephone;
          existingMarin.metier = marin.metier;
          existingMarin.photo = photoPreview.querySelector('img')?.src || existingMarin.photo;
          existingMarin.cvName = cvFile?.name || existingMarin.cvName;
          existingMarin.certificatsNames = certificatsFiles ? 
            Array.from(certificatsFiles).map(f => f.name) : existingMarin.certificatsNames;
          document.getElementById('marinId').value = "";
        }

        localStorage.setItem('marins', JSON.stringify(marins));
        renderMarins();

        showResult(true, "✅ Votre candidature a été envoyée avec succès !<br>Un email a été envoyé à icsbenin01@gmail.com");
      } else {
        showResult(false, `❌ ${result.message}`);
      }

    } catch (error) {
      console.error('Erreur réseau:', error);
      showResult(false, "❌ Impossible de contacter le serveur.<br>Vérifiez votre connexion ou réessayez plus tard.");
    }
  });

  // Init
  renderMarins();
</script>

</body>
</html>